<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°„ì§€ë‚˜ëŠ” HTML ê³„ì‚°ê¸°</title>
    <!-- Tailwind CSS CDN ë§í¬ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter í°íŠ¸ ì ìš© */
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-gray-100 p-4 sm:p-6 md:p-8">
    <!-- ê³„ì‚°ê¸° ë³¸ì²´: ê·¸ë¦¼ì, ë‘¥ê·¼ ëª¨ì„œë¦¬, ë°˜ì‘í˜• ìµœëŒ€ ë„ˆë¹„ ì„¤ì •, ë¯¼íŠ¸ìƒ‰ ë°°ê²½ -->
    <div class="bg-emerald-200 shadow-xl rounded-2xl w-full max-w-md p-6 sm:p-8">
        <!-- ê²°ê³¼ í‘œì‹œ í™”ë©´ -->
        <div class="bg-gray-800 text-white rounded-xl p-4 mb-4 text-right overflow-hidden shadow-inner">
            <!-- ì…ë ¥ê°’ í‘œì‹œ (ì‘ì€ ê¸€ì”¨) -->
            <div id="inputDisplay" class="text-xl sm:text-2xl text-gray-400 h-8 sm:h-10 overflow-hidden break-all"></div>
            <!-- ê²°ê³¼ê°’ í‘œì‹œ (í° ê¸€ì”¨) -->
            <div id="resultDisplay" class="text-3xl sm:text-5xl font-bold h-12 sm:h-16 overflow-hidden break-all">0</div>
        </div>

        <!-- ë²„íŠ¼ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ -->
        <div class="grid grid-cols-4 gap-3 sm:gap-4">
            <!-- ë²„íŠ¼ë“¤ì€ JavaScriptë¡œ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
        </div>
    </div>

    <script>
        // JavaScript ì½”ë“œ ì‹œì‘
        const inputDisplay = document.getElementById('inputDisplay');
        const resultDisplay = document.getElementById('resultDisplay');
        const buttonGrid = document.querySelector('.grid-cols-4');

        let currentInput = ''; // í˜„ì¬ ì…ë ¥ëœ ìˆ˜ì‹
        let currentResult = ''; // ê³„ì‚° ê²°ê³¼

        // ìˆ˜ì‹ì„ ì•ˆì „í•˜ê²Œ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ (eval ëŒ€ì‹  ì‚¬ìš©)
        const evaluateExpression = (expression) => {
            // ê³±ì…ˆ/ë‚˜ëˆ—ì…ˆ ê¸°í˜¸ëŠ” JavaScriptì— ë§ê²Œ * / ë¡œ ë³€í™˜
            expression = expression.replace(/Ã—/g, '*').replace(/Ã·/g, '/');

            // ìˆ«ì, ì†Œìˆ˜ì , ìŒìˆ˜ ë¶€í˜¸, ì—°ì‚°ìë¡œ í† í° ë¶„ë¦¬
            // ì˜ˆ: "5+3*(-2)/4" -> ['5', '+', '3', '*', '(', '-2', ')', '/', '4']
            // ìŒìˆ˜ ì‹œì‘ì„ ê³ ë ¤í•˜ì—¬ ì •ê·œì‹ ìˆ˜ì •: ^-? ë¡œ ì‹œì‘í•˜ëŠ” ìŒìˆ˜ ìˆ«ìë„ ì¸ì‹
            const tokens = expression.match(/(-?\d+\.?\d*)|([+\-*/])/g);

            if (!tokens || tokens.length === 0) return NaN;

            const parsedTokens = tokens.map(token => {
                if (token.match(/^-?\d+\.?\d*$/)) {
                    return parseFloat(token);
                }
                return token;
            });

            // 1ì°¨ ê³„ì‚°: ê³±ì…ˆê³¼ ë‚˜ëˆ—ì…ˆ ì²˜ë¦¬
            let tempArr = [];
            let i = 0;
            while (i < parsedTokens.length) {
                if (parsedTokens[i] === '*' || parsedTokens[i] === '/') {
                    const operator = parsedTokens[i];
                    const prevVal = tempArr.pop();
                    const nextVal = parsedTokens[i + 1];

                    if (typeof prevVal !== 'number' || typeof nextVal !== 'number') return NaN;

                    let res;
                    if (operator === '*') {
                        res = prevVal * nextVal;
                    } else if (operator === '/') {
                        if (nextVal === 0) return Infinity;
                        res = prevVal / nextVal;
                    }
                    tempArr.push(res);
                    i += 2;
                } else {
                    tempArr.push(parsedTokens[i]);
                    i += 1;
                }
            }

            // 2ì°¨ ê³„ì‚°: ë§ì…ˆê³¼ ëº„ì…ˆ ì²˜ë¦¬
            if (tempArr.length === 0) return NaN;

            let finalResult = tempArr[0];
            i = 1;
            while (i < tempArr.length) {
                if (tempArr[i] === '+' || tempArr[i] === '-') {
                    const operator = tempArr[i];
                    const nextVal = tempArr[i + 1];

                    if (typeof nextVal !== 'number') return NaN;

                    if (operator === '+') {
                        finalResult += nextVal;
                    } else if (operator === '-') {
                        finalResult -= nextVal;
                    }
                    i += 2;
                } else {
                    return NaN; // ì˜ëª»ëœ ìˆ˜ì‹
                }
            }
            return finalResult;
        };

        // ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬ í•¨ìˆ˜
        const handleClick = (value) => {
            if (value === 'C') {
                currentInput = '';
                currentResult = '';
                inputDisplay.textContent = '';
                resultDisplay.textContent = '0';
            } else if (value === '=') {
                try {
                    const calculatedResult = evaluateExpression(currentInput);
                    if (isNaN(calculatedResult)) {
                        resultDisplay.textContent = 'ì˜¤ë¥˜';
                    } else if (!isFinite(calculatedResult)) {
                        resultDisplay.textContent = 'ë¬´í•œëŒ€';
                    } else {
                        currentResult = calculatedResult.toString();
                        resultDisplay.textContent = currentResult;
                        currentInput = currentResult; // ê³„ì‚° ê²°ê³¼ê°€ ë‹¤ìŒ ì…ë ¥ì˜ ì‹œì‘ì´ ë˜ë„ë¡
                    }
                } catch (error) {
                    resultDisplay.textContent = 'ì˜¤ë¥˜';
                    currentInput = '';
                }
            } else if (value === 'AC') {
                currentInput = '';
                currentResult = '';
                inputDisplay.textContent = '';
                resultDisplay.textContent = '0';
            } else {
                // ê²°ê³¼ê°€ í‘œì‹œëœ ìƒíƒœì—ì„œ ìˆ«ìë‚˜ '.'ì„ ëˆ„ë¥´ë©´ ìƒˆë¡œìš´ ê³„ì‚° ì‹œì‘
                if (currentResult !== '' && !['Ã·', 'Ã—', '-', '+'].includes(value)) {
                    currentInput = value;
                    currentResult = '';
                } else {
                    // ì—°ì‚°ì ì—°ì† ì…ë ¥ ë°©ì§€ (ë‹¨, ìŒìˆ˜ ë¶€í˜¸ëŠ” í—ˆìš©)
                    const lastChar = currentInput.slice(-1);
                    if (['Ã·', 'Ã—', '+', '-'].includes(value) && ['Ã·', 'Ã—', '+', '-'].includes(lastChar)) {
                        if (!(value === '-' && !['Ã·', 'Ã—', '+', '-'].includes(lastChar))) { // -5 ê°™ì€ ê²½ìš° í—ˆìš©
                            currentInput = currentInput.slice(0, -1) + value; // ì—°ì‚°ì êµì²´
                        } else {
                            currentInput += value; // -5 ê°™ì€ ê²½ìš° í—ˆìš©
                        }
                    } else {
                        currentInput += value;
                    }
                }
                inputDisplay.textContent = currentInput;
            }
        };

        // ë²„íŠ¼ ë ˆì´ë¸”ì— ê·€ì—¬ìš´ ìºë¦­í„°(ì´ëª¨ì§€) ì¶”ê°€
        const getButtonDisplay = (buttonValue) => {
            switch (buttonValue) {
                case '0': return '0 ğŸ’–';
                case '1': return '1 ğŸŒŸ';
                case '2': return '2 ğŸŒˆ';
                case '3': return '3 ğŸ€';
                case '4': return '4 ğŸ¾';
                case '5': return '5 ğŸŒ»';
                case '6': return '6 ğŸˆ';
                case '7': return '7 âœ¨';
                case '8': return '8 ğŸ’«';
                case '9': return '9 ğŸš€';
                case '.': return '. â­';
                case 'AC': return 'AC ğŸ”„';
                case 'C': return 'C ğŸ—‘ï¸';
                case '=': return '= âœ…';
                default: return buttonValue;
            }
        };

        // ê³„ì‚°ê¸° ë²„íŠ¼ ë ˆì´ì•„ì›ƒ ì •ì˜
        const buttons = [
            { value: 'AC', span: 1, bgColor: 'bg-purple-300 hover:bg-purple-400' },
            { value: 'C', span: 1, bgColor: 'bg-purple-300 hover:bg-purple-400' },
            { value: 'Ã·', span: 1, bgColor: 'bg-pink-300 hover:bg-pink-400' },
            { value: 'Ã—', span: 1, bgColor: 'bg-pink-300 hover:bg-pink-400' },
            { value: '7', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '8', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '9', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '-', span: 1, bgColor: 'bg-pink-300 hover:bg-pink-400' },
            { value: '4', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '5', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '6', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '+', span: 1, bgColor: 'bg-pink-300 hover:bg-pink-400' },
            { value: '1', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '2', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '3', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '=', span: 2, bgColor: 'bg-blue-400 hover:bg-blue-500' },
            { value: '0', span: 2, bgColor: 'bg-emerald-100 hover:bg-emerald-200' },
            { value: '.', span: 1, bgColor: 'bg-emerald-100 hover:bg-emerald-200' }
        ];

        // ë²„íŠ¼ ìƒì„± ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        buttons.forEach(btn => {
            const buttonElement = document.createElement('button');
            buttonElement.textContent = getButtonDisplay(btn.value);
            buttonElement.className = `
                p-4 sm:p-5 rounded-xl text-2xl sm:text-3xl font-semibold 
                transition-all duration-200 ease-in-out
                ${btn.bgColor}
                ${btn.span === 2 ? 'col-span-2' : ''}
                text-gray-800 shadow-sm
            `;
            // ì—°ì‚°ì ë° AC, C, = ë²„íŠ¼ì€ ê¸€ììƒ‰ì„ í°ìƒ‰ìœ¼ë¡œ ë³€ê²½
            if (['AC', 'C', 'Ã·', 'Ã—', '-', '+', '='].includes(btn.value)) {
                buttonElement.classList.remove('text-gray-800');
                buttonElement.classList.add('text-white');
            }
            buttonElement.onclick = () => handleClick(btn.value);
            buttonGrid.appendChild(buttonElement);
        });
    </script>
</body>
</html>
